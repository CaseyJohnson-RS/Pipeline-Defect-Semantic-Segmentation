## Binary Semantic Segmentation (BSS)


В этом эксперименте обучается модель UNet для задачи семантической сегментации фона в канализационных трубах. Так как найти размеченных датасет не удалось, было создано 2 датасета из уже существующего, но предназначенного для задачи детекции 6-ти классов.

  
1. **Pipe Box Segmentation (PBS)** - создан с помощью заливки детекционных боксов оригинального датасета. Данных получилось много, но все они низкого качества.
2. **Pipe Segmentation (PS)** - создан с помощью ручной разметки. Фон и объекты выделены аккуратными контурами, однако размер датасета в 10 раз уступает PBS. Легко переобучить модель.

### Задача

Получить наибольшие метрики IoU и Dice. Напомню их значение и формулы.

**IoU (или Jaccard Index)**

Метрика, показывающая, насколько сильно предсказанная область пересекается с истинной.

- Значение от **0 до 1**
- `1` — идеальное совпадение
- `0` — полное несовпадение

$$
IoU = \frac{|Prediction \cap GroundTruth|}{|Prediction \cup GroundTruth|}
$$

**Dice (или Sørensen–Dice coefficient)** 

Метрика измеряет схожесть двух множеств. Он чуть *мягче* к небольшим ошибкам, чем IoU.

- Значение от **0 до 1**
- `1` — идеальное совпадение
- `0` — полное несовпадение

$$
Dice = \frac{2 \times |Prediction \cap GroundTruth|}{|Prediction| + |GroundTruth|}
$$

### Конфигурация эксперимента

В файле `config.py` находятся конфигурационные переменные. Везде, где написано **не трогать**, лучше не трогать, иначе поломается логика работы. Параметры, которые можно менять:

- SEED - детерминирует случайность
- \_EPOCHS - количество эпох обучения
- \_LEARNING_RATE - скорость обучения
- \_BATCH_SIZE - количество изображени, по которым усредняется Loss 
- \_OPTIMIZER - оптимизатор, не думаю, что его стоит менять
- \_CRITETION - функция потерь, можно поиграться

### Запуск эксперимента

После конфигурации можно запустить файл `experiment.py` и готово! Несколько правил:
 - Пишите своё имя латиницей. Если ввели неправильное имя, то всегда можно запустить скрипт заново.
 - Если видите, что результаты очень плачевные, то при запросе сохранить модель на сервер, лучше воздержаться, чтобы сохранить время и память.