## Binary Semantic Segmentation (BSS)


В этом эксперименте обучается модель UNet для задачи семантической сегментации фона в канализационных трубах. Так как найти размеченный датасет не удалось, было создано 2 датасета из уже существующего, но предназначенного для задачи детекции 6-ти классов.

  
1. **Pipe Box Segmentation (PBS)** - создан с помощью заливки детекционных боксов оригинального датасета. Данных получилось много, но все они низкого качества.
2. **Pipe Segmentation (PS)** - создан с помощью ручной разметки. Фон и объекты выделены аккуратными контурами, однако размер датасета в 50-100 раз уступает PBS. Легко переобучить модель.

### Задача

Получить наибольшие метрики IoU и Dice. Напомню их значение и формулы.

**IoU (или Jaccard Index)**

Метрика, показывающая, насколько сильно предсказанная область пересекается с истинной.

- Значение от **0 до 1**
- `1` — идеальное совпадение
- `0` — полное несовпадение

$$
IoU = \frac{|Prediction \cap GroundTruth|}{|Prediction \cup GroundTruth|}
$$

**Dice (или Sørensen–Dice coefficient)** 

Метрика измеряет схожесть двух множеств. Он чуть *мягче* к небольшим ошибкам, чем IoU.

- Значение от **0 до 1**
- `1` — идеальное совпадение
- `0` — полное несовпадение

$$
Dice = \frac{2 \times |Prediction \cap GroundTruth|}{|Prediction| + |GroundTruth|}
$$

### Конфигурация эксперимента

В файле `config.yaml` находятся конфигурационные переменные. Параметры:

```yaml
seed: 42

epochs: 5                           # Число эпох
learning_rate: 0.0001               # Скорость обучения
batch_size: 4                       # Размер батча
criterion:                          # Функция потерь
  name: WeightedCrossEntropyLoss    # Название функции потерь
  args:                             # Аргументы конструктора
    background_weight: 0.99
    object_weight: 1.0
    reduction: mean

dataset: PipeBoxSegmentation        # Название датасета, совпадает 
                                    # с названием дирекотрии
image_size: [704, 512]              # Размер картинки, к которым 
                                    # приводятся изображения в датасете
model:                              # Модель
  name: UNet                        # Название модели
  args:                             # Аргументы конструктора
    encoder_name: mobilenet_v2
    encoder_weights: imagenet
    in_channels: 3
    classes: 1

val_per_epoch: 10                   # Число валидаций в эпоху
visualization_samples: 20           # Количество картинок, которые будут
                                    # использованы для тестовых предсказаний
```

### Запуск эксперимента

После конфигурации можно запустить файл `experiment.py` и готово!